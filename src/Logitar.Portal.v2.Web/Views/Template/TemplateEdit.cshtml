@using Logitar.Portal.v2.Contracts.Senders;
@using Logitar.Portal.v2.Contracts.Templates;

@inject ISenderService _senderService;

@model Template
@{
  Layout = "_Layout";

  ViewBag.Title = Model?.DisplayName ?? Model?.Key ?? "Create template";

  string? sender = null;
  if (Model != null)
  {
    Sender? defaultSender = await _senderService.GetAsync(defaultInRealm: Model.Realm.Id.ToString());
    sender = defaultSender == null ? null : ModelSerializer.Serialize(defaultSender);
  }
}

@if (Model == null)
{
  <template-edit realm="@(Context.Request.Query["realm"])"></template-edit>
}
else
{
  <template-edit json="@(ModelSerializer.Serialize(Model))" sender="@(sender)" status="@(Context.Request.Query["status"])" user="@(ModelSerializer.Serialize(Context.GetCurrentUser()))"></template-edit>
}
