@using Logitar.Portal.Contracts.Users;
@using Logitar.Portal.Core;
@using Logitar.Portal.Core.Configurations;
@using Logitar.Portal.Core.Configurations.Queries;
@using MediatR;

@inject IApplicationContext _applicationContext;
@inject IMediator _mediator;

@model User
@{
  Layout = "_Layout";

  ViewBag.Title = Model?.FullName ?? Model?.Username ?? "Create user";

  Configuration configuration = await _mediator.Send(new ProjectToConfigurationOutput(_applicationContext.Configuration));
}

@if (Model == null)
{
  <user-edit configuration="@(ModelSerializer.Serialize(configuration))" realm="@(Context.Request.Query["realm"])"></user-edit>
}
else
{
  <user-edit configuration="@(ModelSerializer.Serialize(configuration))" current="@(Context.GetUser()?.Id)" json="@(ModelSerializer.Serialize(Model))" status="@(Context.Request.Query["status"])"></user-edit>
}
